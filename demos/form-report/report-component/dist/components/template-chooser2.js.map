{"file":"template-chooser2.js","mappings":"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","names":[],"sources":["src/components/template-chooser/template-chooser.scss?tag=template-chooser&encapsulation=shadow","src/components/template-chooser/template-chooser.tsx"],"sourcesContent":[":host {\n  display: block;\n  padding: 0 0.75rem;\n  calcite-notice {\n    margin-top: 6px;\n  }\n  .heading {\n    margin-inline: 0px;\n    margin-block:  1.25rem 1rem;\n    font-size: var(--calcite-font-size-0);\n    line-height: 1.25rem;\n    font-weight: var(--calcite-font-weight-medium);\n  }\n}\n","import { Component, Host, Prop, State, Watch, Element, Event, EventEmitter, h } from '@stencil/core';\nimport { PropsService } from '../../services/props.service';\nimport { ReportService } from '../../services/report.service';\n// import { TranslateService } from '../../services/translate.service';\nimport { StateService } from '../../services/state.service';\nimport { TranslateService } from '../../services/translate.service';\n\n@Component({\n  tag: 'template-chooser',\n  styleUrl: 'template-chooser.scss',\n  shadow: true,\n})\nexport class TemplateChooser {\n  @Prop() langObj: any;  \n  @Prop() selectedTemplateId: any;  \n  @Watch('selectedTemplateId')\n  selectedTemplateIdChanged() {\n    this.reportService.setParamCache({\n      templateItemId: this.selectedTemplateId\n    });\n  }\n\n  @Prop() templateIds: string;\n  @Watch('templateIds')\n  templateIdsChanged() {\n    this.init();\n  }\n  \n  @Element() element: HTMLElement;\n  @Event() selectedTemplateChange: EventEmitter<any>;\n  @State() templates: any[] =[];\n  @State() translator: any;\n  private reportService: ReportService = ReportService.getService();\n  private stateService: StateService = StateService.getService();\n\n  componentWillLoad() {\n    this.reportService.setParamCache({\n      templateItemId: this.selectedTemplateId\n    });\n    return Promise.resolve(true)\n    // .then(() => {\n    //   return TranslateService.getService().getTranslate();\n    // })\n    .then(() => {\n      const res = TranslateService.getService().getTranslateSync();\n      this.translator = res;\n      this.stateService.subscribe('locale-data-changed', (data) => {\n        this.translator = data;\n      });\n      return this.init();\n    });\n  }\n\n  init() {\n    const globalProps = PropsService;\n    const reportService: ReportService = ReportService.getService();\n    return Promise.resolve(true).then(() => {\n      if (this.templateIds === undefined) {\n        return reportService.getReportTemplates(globalProps.surveyItemId);\n      } else {\n        return reportService.getReportTemplates(globalProps.surveyItemId, {templateIds: this.templateIds});\n      }\n    })\n    .then((templates) => {\n      this.templates = templates;\n      this.stateService.notifyDataChanged('print-templates-updated', {value: templates});\n      this.reportService.setHelperObj({\n        printTemplates: templates\n      });\n      // use the first one as default, if the selected template id is not provided\n      if (!this.selectedTemplateId && templates.length) {\n        this.selectedTemplateId = templates[0].id;\n        this.reportService.setParamCache({\n          templateItemId: this.selectedTemplateId\n        });\n        this.selectedTemplateChange.emit(this.selectedTemplateId);\n      }\n      return true;\n    }).catch((err) => {\n      this.reportService.showError(err);\n    })\n  }\n\n  /**\n   * \n   * @param evt \n   */\n  public selectedTemplateChangeHandler(evt) {\n    this.reportService.setParamCache({\n      templateItemId: evt.target.value\n    });\n\n    this.selectedTemplateChange.emit(evt.target.value);\n  }\n\n  render() {\n    return (\n      <Host>\n        {/* <calcite-label> */}\n          <div class=\"heading\">{this.translator?.customPrint.chooseTemplateLabel1}</div>\n          <calcite-combobox placeholder={this.translator?.customPrint.chooseTemplateLabel1} selection-mode=\"single-persist\" clearDisabled=\"true\" value={this.selectedTemplateId} onCalciteComboboxChange={(evt) => {this.selectedTemplateChangeHandler(evt)}}>\n            {(this.templates || []).map((template) => {\n              return <calcite-combobox-item value={template.id} text-label={template.title} selected={template.id===this.selectedTemplateId}></calcite-combobox-item>;\n            })}\n          </calcite-combobox>\n          {(this.templates || []).length > 0 ?\n            null : \n            <calcite-notice open kind=\"danger\" scale=\"s\" width=\"auto\"> \n                <div slot=\"message\">{this.translator?.customPrint.chooseTemplateNoOneYet1}</div>\n            </calcite-notice>\n          }\n        {/* </calcite-label> */}\n        <slot></slot>\n      </Host>\n    );\n  }\n\n}\n"],"version":3}