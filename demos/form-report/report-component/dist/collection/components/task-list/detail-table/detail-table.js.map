{"version":3,"file":"detail-table.js","sourceRoot":"","sources":["../../../../src/components/task-list/detail-table/detail-table.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, Host, Element, State, Prop, h } from '@stencil/core';\nimport { TranslateService } from '../../../services/translate.service';\nimport { UtilService } from '../../../services/util.service';\n\n@Component({\n  tag: 'detail-table',\n  styleUrl: 'detail-table.scss',\n  shadow: true,\n})\nexport class ReportDetailTable {\n  @Prop() job: any;\n  @State() errorMsg: string;\n  @Element() host: HTMLElement;\n  private langTasks: any;\n\n  public statusI18nConfig: any;\n\n  componentWillLoad() {\n    const utilService: UtilService = UtilService.getService();\n    this.errorMsg = utilService.parseMarkdown(this.job.messages&&this.job.messages.length?this.job.messages.join('<br>'):'');\n    return Promise.resolve(true)\n    // .then(() => {\n    //   return TranslateService.getService().getTranslate();\n    // })\n    .then(() => {\n      const res = TranslateService.getService().getTranslateSync();\n      const langTasks = res?.customPrint?.recentTasks;\n      this.langTasks = langTasks;\n      this.statusI18nConfig = {\n        esriJobWaiting: langTasks.jobStatusWaiting,\n        esriJobSubmitted: langTasks.jobStatusSubmitted,\n        esriJobExecuting: langTasks.jobStatusExecuting,\n        esriJobSucceeded: langTasks.jobStatusSucceeded,\n        esriJobFailed: langTasks.jobStatusFailed,\n        pdfConverting: langTasks.pdfConverting,\n        pdfConverted: langTasks.pdfConverted,\n        dfConvertFailed: langTasks.dfConvertFailed\n      };\n    })\n\n  }\n\n  public getPercentage(p) {\n    const utilService: UtilService = UtilService.getService();\n    return utilService.getPercentage(this.job, p);\n  }\n\n  /**\n   * open the error detailed modal\n   */\n  private errorDetailModalOpen() {\n    const modal = this.host.shadowRoot?.querySelector('.error-modal');\n    (modal as any).open = true;\n  }\n\n  /**\n   * open the success detailed modal\n   */\n  private succeedDetailModalOpen() {\n    const modal = this.host.shadowRoot?.querySelector('.success-modal');\n    (modal as any).open = true;\n  }\n\n\n  render() {\n    return (\n      <Host>\n        <calcite-table caption=\"job details\" striped>\n            <calcite-table-row>\n                <calcite-table-cell>{this.langTasks.detailJobID}</calcite-table-cell>\n                <calcite-table-cell>{this.job.jobId}</calcite-table-cell>\n            </calcite-table-row>\n            <calcite-table-row>\n                <calcite-table-cell>{this.langTasks.detailStatus}</calcite-table-cell>\n                <calcite-table-cell>\n                <div>\n                  <span>{this.statusI18nConfig[this.job.jobStatus]}</span>\n                  {this.job.jobStatus=='esriJobPartialSucceeded'&&this.job.resultInfo.totalCount ? \n                    <span>{this.langTasks.jobStatusPartialSucceeded.replace('${$completedPercent}', `${this.getPercentage(1-this.job.resultInfo.failedObjectIds.length/this.job.resultInfo.totalCount)}`)}\n                    </span>: ''\n                  }\n                </div>\n              </calcite-table-cell>\n            </calcite-table-row>\n            <calcite-table-row>\n                <calcite-table-cell>{this.langTasks.detailStatusMsg}</calcite-table-cell>\n                <calcite-table-cell>\n                  <div innerHTML={this.errorMsg} title={this.errorMsg}>\n                  </div>\n                </calcite-table-cell>\n            </calcite-table-row>\n            <calcite-table-row>\n                <calcite-table-cell>{this.langTasks.detailFailedOIDs} {( this.job.resultInfo&&this.job.resultInfo.failedObjectIds&&this.job.resultInfo.failedObjectIds.length ? ' (' + this.job.resultInfo.failedObjectIds.length + ') ' : '' ) }</calcite-table-cell>\n                <calcite-table-cell>\n                  {this.job.resultInfo&&this.job.resultInfo.failedObjectIds&&this.job.resultInfo.failedObjectIds.length ?\n                    <div>\n                      <p class=\"max-tow-lines\" title={this.job.resultInfo.failedObjectIds.join(',')}>\n                        {this.job.resultInfo.failedObjectIds.join(',')}\n                      </p>\n                        \n                      {this.job.resultInfo.details&&this.job.resultInfo.details.length ? \n                        <p class=\"more-details\">\n                          <a onClick={() => this.errorDetailModalOpen()}>{this.langTasks.detailMoreDetails}</a>\n                        </p> : ''\n                      }\n                  </div>\n                  : ''\n                }\n              </calcite-table-cell>\n            </calcite-table-row>\n            <calcite-table-row>\n                <calcite-table-cell>{this.langTasks.detailSucceededOIDs} {this.job.resultInfo&&this.job.resultInfo.succeededObjectIds&&this.job.resultInfo.succeededObjectIds.length?this.job.resultInfo.succeededObjectIds.length:''}</calcite-table-cell>\n                <calcite-table-cell>\n                  {this.job.resultInfo&&this.job.resultInfo.succeededObjectIds&&this.job.resultInfo.succeededObjectIds.length ? \n                    <div>\n                      <p class=\"max-tow-lines\" title={this.job.resultInfo.succeededObjectIds.join(',')}>\n                        {this.job.resultInfo.succeededObjectIds.join(',')}</p>\n                      <p class=\"more-details\">\n                        <a onClick={() => this.succeedDetailModalOpen()}>{this.langTasks.detailMoreDetails}</a>\n                      </p>\n                    </div>: ''\n                  }\n                </calcite-table-cell>\n            </calcite-table-row>\n        </calcite-table>\n\n        {/* <table class=\"table table-striped\">\n          <tr>\n            <td>{this.langTasks.detailJobID}</td>\n            <td>\n              <div>{this.job.jobId}</div>\n            </td>\n          </tr>\n          <tr>\n            <td>{this.langTasks.detailStatus}</td>\n            <td>\n              <div>\n                <span>{this.statusI18nConfig[this.job.jobStatus]}</span>\n                {this.job.jobStatus=='esriJobPartialSucceeded'&&this.job.resultInfo.totalCount ? \n                  <span>{this.langTasks.jobStatusPartialSucceeded.replace('${$completedPercent}', `${this.getPercentage(1-this.job.resultInfo.failedObjectIds.length/this.job.resultInfo.totalCount)}`)}\n                  </span>: ''\n                }\n              </div>\n            </td>\n          </tr>\n          <tr>\n            <td>{this.langTasks.detailStatusMsg}</td>\n            <td>\n              <div title={this.errorMsg} innerHTML={this.errorMsg}></div>\n            </td>\n          </tr>\n          <tr>\n            <td>\n              {this.langTasks.detailFailedOIDs} {( this.job.resultInfo&&this.job.resultInfo.failedObjectIds&&this.job.resultInfo.failedObjectIds.length ? ' (' + this.job.resultInfo.failedObjectIds.length + ') ' : '' ) }\n            </td>\n            <td>\n              {this.job.resultInfo&&this.job.resultInfo.failedObjectIds&&this.job.resultInfo.failedObjectIds.length ?\n                  <div>\n                    <p class=\"max-tow-lines\" title={this.job.resultInfo.failedObjectIds.join(',')}>\n                      {this.job.resultInfo.failedObjectIds.join(',')}\n                    </p>\n                      \n                    {this.job.resultInfo.details&&this.job.resultInfo.details.length ? \n                      <p class=\"more-details\">\n                        <a onClick={() => this.errorDetailModalOpen()}>{this.langTasks.detailMoreDetails}</a>\n                      </p> : ''\n                    }\n                </div>\n                : ''\n              }\n            </td>\n          </tr>\n          <tr>\n            <td>\n              {this.langTasks.detailSucceededOIDs} {this.job.resultInfo&&this.job.resultInfo.succeededObjectIds&&this.job.resultInfo.succeededObjectIds.length?this.job.resultInfo.succeededObjectIds.length:''}\n            </td>\n            <td>\n            {this.job.resultInfo&&this.job.resultInfo.succeededObjectIds&&this.job.resultInfo.succeededObjectIds.length ? \n              <div>\n                <p class=\"max-tow-lines\" title={this.job.resultInfo.succeededObjectIds.join(',')}>\n                  {this.job.resultInfo.succeededObjectIds.join(',')}</p>\n                <p class=\"more-details\">\n                  <a onClick={() => this.succeedDetailModalOpen()}>{this.langTasks.detailMoreDetails}</a>\n                </p>\n              </div>: ''\n            }\n\n            </td>\n          </tr>\n        </table> */}\n\n\n        <error-detail-modal class=\"error-modal\" job={this.job}></error-detail-modal>\n\n        <success-detail-modal class=\"success-modal\" job={this.job}></success-detail-modal>\n        <slot></slot>\n      </Host>\n    );\n  }\n\n}\n"]}