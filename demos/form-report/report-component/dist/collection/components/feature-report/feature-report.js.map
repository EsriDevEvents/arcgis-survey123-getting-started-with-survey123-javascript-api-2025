{"version":3,"file":"feature-report.js","sourceRoot":"","sources":["../../../src/components/feature-report/feature-report.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, Fragment, Host, Prop, Watch, State, h, Event, EventEmitter } from '@stencil/core';\n// import { ReportBase } from '../report-base/report-base';\nimport { PropsService } from '../../services/props.service';\nimport { EsriJobStatusType, ReportService } from '../../services/report.service';\nimport { UtilService } from '../../services/util.service';\nimport { TranslateService } from '../../services/translate.service';\nimport { StateService } from '../../services/state.service';\nimport { ArcGISIdentityManager, request, IRequestOptions } from '@esri/arcgis-rest-request';\n\n@Component({\n  tag: 'feature-report',\n  styleUrl: 'feature-report.scss',\n  shadow: true,\n})\nexport class FeatureReport {\n\n  // token \n  @Prop() token!: string;\n\n  @Prop() portalUrl?: string;\n\n  @Prop() apiUrl?: string;\n\n  // Feature layer or table URL. required\n  @Prop() featureLayerUrl!: string;\n\n  @Prop() surveyItemId?: string;\n\n  @Prop() templateItemId?: string;\n  @Watch('templateItemId')\n  templateItemIdChanged(newVal) {\n    PropsService.setProps({templateItemId: newVal});\n  }\n\n  @Prop() queryParameters!: string;  // Object string\n  @Watch('queryParameters')\n  queryParametersChanged(newVal) {\n    PropsService.setProps({\n      queryParameters: newVal\n    });\n    return this.reportService.getFeatureCount().then(()=> {\n      this.stateService.notifyDataChanged('update-features-preview', {value: undefined});  // no not use {value: null} here.\n    })\n  }\n  \n  @Prop() mergeFiles: 'none' | 'nextPage' | 'continuous';  \n  @Watch('mergeFiles')\n  mergeFilesChanged(newVal) {\n    PropsService.setProps({\n      mergeFiles: newVal\n    });\n  }\n\n  @Prop() outputFormat: string;\n  @Watch('outputFormat')\n  outputFormatChanged(newVal) {\n    PropsService.setProps({outputFormat: newVal});\n    this.outputFormat = PropsService.outputFormat;\n  }\n\n  \n  @Prop() outputReportName: string;\n  \n  @Prop() outputPackageName: string;\n  \n  @Prop() packageFiles: boolean | string;\n  \n  @Prop() uploadInfo: string;   // Object string\n  \n  @Prop() webmapItemId: string;\n  \n  @Prop() mapScale: string;\n\n  @Prop() locale?: string;  \n  @Watch('locale')\n  localeChanged(newVal) {\n    this.localeChangeHandler(newVal)\n    UtilService.getService().setDir();\n  }\n\n  @Prop() utcOffset?: string;\n\n  /**\n   * ui parameters\n   */\n  @Prop() show: string;\n  @Watch('show')\n  showChanged(newValue) {\n    // console.log(newValue, oldValue);\n    PropsService.setProps({show: newValue});\n    this.visibleConf = this.generateVisibleElems();\n    this.reportService.setHelperObj({\n      visibleConf: this.visibleConf\n    });\n  }\n\n  @Prop() hide: string;\n  @Watch('hide')\n  hideChanged(newVal) {\n    PropsService.setProps({hide: newVal});\n    this.visibleConf = this.generateVisibleElems();    \n    this.reportService.setHelperObj({\n      visibleConf: this.visibleConf\n    });\n  }\n\n  @Prop() inputFeatureTemplate: string;\n  @Watch('inputFeatureTemplate')\n  inputFeatureTemplateChanged(newVal) {\n    PropsService.setProps({inputFeatureTemplate: newVal});\n    this.stateService.notifyDataChanged('update-features-preview', {value: this.inputFeatureTemplate});\n  }\n  @Prop() label: string;\n  @Watch('label')\n  labelChanged(newVal) {\n    PropsService.setProps({label: newVal});\n    return Promise.resolve(true)    \n    .then(() => {\n      return TranslateService.getService().getTranslate();\n    })\n    .then((res) => {\n      const langTasks = res.customPrint.recentTasks;\n      this.langCustomPrint = res.customPrint;\n      this.langTasks = langTasks;\n      this.langCommon = res.common;\n      this.stateService.notifyDataChanged('locale-data-changed', {value: res});\n    });\n  }\n\n  @Prop() reportTemplateIds: string;\n  @Watch('reportTemplateIds')\n  reportTemplateIdsChanged(newVal) {\n    PropsService.setProps({\n      reportTemplateIds: newVal\n    });\n    // the select segment is hidden, update the report templates\n    this.updateTemplateList();\n  }\n\n  @Prop() clientId: string;\n\n  @Prop() requestSource: string;\n  @Watch('requestSource')\n  requestSourceChanged(newVal) {\n    PropsService.setProps({\n      requestSource: newVal\n    });\n  }\n\n  // @Prop() redirectUri: string; // must be the same with current url\n\n  \n  @Event() userInfoGetted: EventEmitter<any>;\n  @Event() i18nStringUpdated: EventEmitter<any>;\n  @Event() _credentialGetted: EventEmitter<any>; // internal\n  \n\n  // @Method()\n  // convertToSupportedLang(locale: string) {\n  //   return Promise.resolve(PropsService.convertToSupportedLang(locale));\n  // }\n\n  // @Method()\n  // getI18nCommonString() {\n  //   return Promise.resolve(this.langCommon);\n  // }\n\n  /**\n   * the following parameters are geneareted by the main parameters, ie:\n   * the where is genereated from queryParameters\n   * the username is generated from token \n   */\n  @State() where: string;    // todo: remove it\n  @State() username?: string;\n  @State() state: string = 'generate-report';\n  @State() visibleConf: string[] = [];\n  @State() checkingList: string[] = [];\n  @State() jobs: any[] = [];\n  @State() error: any;\n  @State() langTasks: any;\n  @State() langCommon: any;\n  @State() langCustomPrint: any;\n  @State() surveyItemInfo: any;\n\n  private stateService: StateService =  StateService.getService();\n  private reportService: ReportService = ReportService.getService();\n\n  componentWillLoad() {\n    PropsService.setProps(this);\n    this.portalUrl = PropsService.portalUrl;\n    this.outputFormat = PropsService.outputFormat;\n    return Promise.resolve(true)    \n    .then(() => {\n      return TranslateService.getService().getTranslate();\n    })\n    .then((res) => {\n      const langTasks = res.customPrint.recentTasks;\n      this.langCustomPrint = res.customPrint;\n      this.langTasks = langTasks;\n      this.langCommon = res.common;\n      this.i18nStringUpdated.emit({locale: PropsService.locale, i18n: this.langCommon});\n      if (!this.isOAuthCallbackpage()) {\n        if (!this.featureLayerUrl) {\n          this.error = {html: res.customPrint.missingRequiredParamsErr.replace('${$paramName}', `featureLayerUrl`)};\n          throw new Error('featureLayerUrl is required.');\n        }\n        if (!this.queryParameters) {\n          this.error = {html: res.customPrint.missingRequiredParamsErr.replace('${$paramName}', `queryParameters`)};\n          throw new Error('queryParameters is required.');\n        }\n      }\n    })\n    .then(() => {\n      if (this.token) {\n        this.init();\n        return true;\n      } else if (!this.token) {\n        // the callback page navigated from the oauth page\n        if (this.isOAuthCallbackpage()) {\n          /**\n           * the code is added from the oauth page navigation, as this is a web component, we can't use a dedicated oauth callback page, we have to use the original page,\n           * but if set the redirectUri as window.location.href here, the completeOAuth2 request will return invalid redirectUri error, because the url parameter has 'codes' and 'state'\n           * in fact, we didn't know what the correct redirectUri is, because it's not set by us, we are not the client id owner.\n           * so, maybe we should not call the ArcGISIdentityManager.beginOAuth2() here.\n           * Need a discussion with team.\n           */\n          const portalRest = `${this.portalUrl}/sharing/rest`;\n          const url = new URL(window.location.href);\n          const redirect_url = `${url.origin}${url.pathname}?portalUrl=${this.portalUrl}&isOAuthCallback=true`;\n          // #749, the redirect_url in completeOAuth2 and beginOAuth2 must be the same.\n          ArcGISIdentityManager.completeOAuth2({portal: portalRest, popup: true, clientId: this.clientId, redirectUri: redirect_url});\n          return;\n        } else {\n          // there is a bug in the platformSelf function inside of the @esri/arcgis-rest-request: the request: the \"withCredentials\" is from \n          // platformSelf(this.clientId, 'https://localhost:3333/', this.portalUrl).then(response => {\n          const requestUrl = `${this.portalUrl}/sharing/rest/oauth2/platformSelf?f=json`;\n          const param: IRequestOptions = {\n            httpMethod: 'POST',\n            headers: {\n              \"X-Esri-Auth-Client-Id\": this.clientId,\n              \"X-Esri-Auth-Redirect-Uri\": window.location.href\n            },\n            params: {\n              f: 'json'\n            },\n            credentials: 'include'\n          };\n          return request(requestUrl, param).then((response) => {\n            if (response.expires_in) {\n              response.expires = new Date().valueOf() + response.expires_in * 1000 - 1000 * 5;\n              delete response.expires_in;\n            }\n\n            this._credentialGetted.emit(response);\n            this.token= response.token;\n              PropsService.setProps(this);\n              this.init();\n              return true;\n            }).catch(() =>{\n              this.state = 'login';\n              // this.switchState('login');\n              // (document.querySelector('#login-modal') as any).open = true;\n              // return this.waitingUserLogin();\n            })\n      \n          }\n      }\n    }).catch((e) => {\n      console.error(e);\n    })\n\n  }\n\n  /**\n   * init the component\n   * before enter in this function, the token prop must be ready\n   */\n  init() {\n    // init the constructor of the props service\n    const utilService: UtilService = UtilService.getService();\n\n    this.stateService.subscribe('job-complete', (job) => {\n      const idx = this.checkingList.indexOf(job.jobId);\n      if (idx >= 0) {\n        if (job.jobStatus === EsriJobStatusType.partialSucceeded || job.jobStatus === EsriJobStatusType.succeeded) {\n          if (job?.resultInfo?.resultFiles) {\n            this.checkingList.splice(idx, 1);\n            this.checkingList = [].concat(this.checkingList);\n            this.reportService.downloadReport(job);\n          }\n        }\n      }\n    });\n    this.stateService.subscribe('show-error', (err) => {\n      this.error = err;\n    });\n\n    return Promise.resolve(true)\n    .then(() => {\n      // PropsService.setProps(this);\n      if (this.uploadInfo) {\n        this.reportService.setParamCache({\n          uploadInfo: JSON.parse(this.uploadInfo)\n        });\n      }\n      return true;\n    })\n    // .then(() => {\n    //   return TranslateService.getService().getTranslate();\n    // })\n    // .then((res) => {\n    //   const langTasks = res.customPrint.recentTasks;\n    //   this.langTasks = langTasks;\n    // })\n    .then(() => {\n      return utilService.getPortalInfo();\n    }).then((portalInfo: any) => {\n      /**\n       * check canCreateItem privilege\n       */\n      \n      const canCreateItem = portalInfo.user.privileges.includes('portal:user:createItem');\n      this.reportService.setHelperObj({canCreateItem: canCreateItem});\n      this.userInfoGetted.emit(portalInfo.user);\n      if (!this.locale) {\n        const newLocale = PropsService.getLocale({\n          userInfo: portalInfo.user,\n          portalInfo: portalInfo\n        });\n        if (newLocale !== PropsService.locale) {\n          this.localeChangeHandler(newLocale);\n        }\n      } else {\n        this.i18nStringUpdated.emit({locale: this.locale, i18n: this.langCommon});\n      }\n      UtilService.getService().setDir();\n      \n      // show elements after user info is gotten, because the user name is needed for the report setting section.\n      this.visibleConf = this.generateVisibleElems();\n      this.reportService.setHelperObj({\n        visibleConf: this.visibleConf\n      });\n      this.stateService.notifyDataChanged('portal-info-updated');\n      if (PropsService.surveyItemId) {\n        return utilService.getSurveyItemInfo(PropsService.surveyItemId);\n      }\n      // return true;\n    })\n    .catch((e) => {\n      this.reportService.setHelperObj({surveyIsInvalid: true});\n      this.surveyItemInfo = {};\n\n      this.reportService.manageError(e, 'surveyItemId');\n    })\n    .then((surveyItemInfo) => {\n      this.surveyItemInfo = surveyItemInfo;\n      this.reportService.setHelperObj({surveyIsInvalid: false});\n      this.reportService.initParamCache();\n      return this.reportService.getFeatureCount();\n    })\n    .then(() => {\n      this.stateService.notifyDataChanged('update-features-preview', {value: undefined});\n      // if the template chooser component will hidden, get the templates\n      // todo: seems we only need to choose the selected template?\n      return this.updateTemplateList()\n    })\n    .catch((err) => {\n      if (err.message && !err.html) {\n        err.html = err.message;\n      }\n      this.error = err;\n    });\n  }\n\n  /**\n   * todo: when the component is embeded in an iframe, will hit the same-origin policy problem:\n   * the beginOAuth2 is called in iframe, it will write some info(stateId) to localStorage, but the completeOAuth2 will called in a stanalone page, it cann't read the stateId.\n   * @returns \n   */\n  startLogin() {\n    const portalRest = `${this.portalUrl}/sharing/rest`;\n    const url = new URL(window.location.href);\n    const redirect_url = `${url.origin}${url.pathname}?portalUrl=${this.portalUrl}&isOAuthCallback=true`;\n    return ArcGISIdentityManager.beginOAuth2({portal: portalRest, popup: true, clientId: this.clientId, redirectUri: redirect_url}).then((idm: ArcGISIdentityManager) => {\n      this.token= idm.token;\n      PropsService.setProps(this);\n      this.switchState('generate-report');\n      this.init();\n      this._credentialGetted.emit(idm.toCredential());\n      return true;\n     })  \n  }\n\n  isOAuthCallbackpage() {\n    const url = new URL(window.location.href);\n    return (url.search + '').includes(\"isOAuthCallback=true\");\n  }\n\n  /**\n   * locale change handler\n   * @param newLocale \n   * @returns \n   */\n  localeChangeHandler(newLocale) {\n    PropsService.setProps({locale: newLocale});\n    return Promise.resolve(true)    \n    .then(() => {\n      return TranslateService.getService().getTranslate();\n    })\n    .then((res) => {\n      const langTasks = res.customPrint.recentTasks;\n      this.langCustomPrint = res.customPrint;\n      this.langTasks = langTasks;\n      this.langCommon = res.common;\n      this.stateService.notifyDataChanged('locale-data-changed', {value: res});\n      this.i18nStringUpdated.emit({locale: newLocale, i18n: this.langCommon});\n\n      return true;\n    });\n  }\n\n  /**\n   * get visible elements\n   * @returns \n   */\n  generateVisibleElems() {\n    const elems = ['inputFeatures', 'selectTemplate', 'fileOptions', 'reportName', 'saveToAGSAccount', 'outputFormat', 'showCredits', 'recentReports'];\n    \n    let result = [];\n    if (this.show?.length) {\n      result = this.show.split(',');\n    } else if (this.hide?.length) {\n      const hides = this.hide.split(',');\n      result = elems.filter((ele) => {\n        return hides.indexOf(ele) < 0;\n      })\n    } else {\n      result = elems;\n    }\n    if (result.indexOf('fileOptions') < 0 && result.indexOf('reportName') < 0 && result.indexOf('saveToAGSAccount') < 0 && result.indexOf('outputFormat') < 0) {\n      //\n    } else {\n      result.push('reportSetting');\n    }\n    return [].concat(result);\n  }\n\n  switchState(state) {\n    this.state = state;\n  }\n\n  /**\n   * update template list\n   * @returns \n   */\n  updateTemplateList() {\n    return Promise.resolve(true).then(() => {\n      if (this.visibleConf.indexOf('selectTemplate') < 0 ) {\n        const param = this.reportTemplateIds === undefined ? {} : {templateIds: this.reportTemplateIds}\n        return this.reportService.getReportTemplates(this.surveyItemId, param);\n      }\n    })\n    .then((templates) => {\n      if (templates) {\n        this.reportService.setHelperObj({\n          printTemplates: templates\n        });\n        this.stateService.notifyDataChanged('print-templates-updated', {value: templates});\n        // set the first template as the default template if the templateItemId is not provided.\n\n        const paramStore: any = this.reportService.getParamCache();\n        const templateItemId = paramStore.templateItemId || PropsService.templateItemId;\n        if (!templateItemId && templates.length) {\n          const selectedTemplateId = templates[0].id;\n          this.reportService.setParamCache({\n            templateItemId: selectedTemplateId\n          });\n          // this.selectedTemplateChange.emit(this.selectedTemplateId);\n        }\n      }\n    });\n  }\n\n  generateReportHander(evt) {\n    const detail = evt.detail;\n    this.jobs = detail.jobs;\n    // this.checkingList.push()\n    this.checkingList = [...this.checkingList, evt.detail.jobId];\n    // if (this.visibleConf.indexOf('recentReports') >= 0) {\n    this.state = 'report-list';\n    // }\n    // this.checkingList = [].concat(detail.checkingList || []);\n  }\n\n  render() {\n    return (\n      <Host>\n        <calcite-panel>\n          <div style={{display: (this.state === 'generate-report' && this.token) ? 'block': 'none'}}>\n            {/* features preview */}\n            \n            {this.visibleConf.indexOf('inputFeatures') <0 ? '' : <features-preview queryParameters={this.queryParameters} inputFeatureTemplate={this.inputFeatureTemplate}></features-preview>}\n            \n            {/* select print template */}\n            {this.visibleConf.indexOf('selectTemplate') <0 || !this.surveyItemInfo ? '' : <template-chooser selectedTemplateId={this.templateItemId} templateIds={this.reportTemplateIds}></template-chooser>}\n            \n            {this.visibleConf.indexOf('reportSetting') <0 ? '' : <report-settings visibleElems={this.visibleConf} mergeFiles={this.mergeFiles} outputFormat={this.outputFormat} fileName={this.outputReportName}></report-settings>}\n            \n            <report-generator visibleConf={this.visibleConf} templateItemId={this.templateItemId} onReportCreated={(evt) => {this.generateReportHander(evt)}}></report-generator>\n            \n            {/* {this.visibleConf.indexOf('recentReports') <0 ? '' : <view-report-link checkingList={this.checkingList} onViewReportLinkClicked={() => this.switchState('report-list')}></view-report-link>} */}\n            \n            {/* recent tasks action */}\n            {this.visibleConf.indexOf('recentReports') <0 ?\n              null: \n              <div class=\"banner\">        \n                {/* <calcite-action onClick={() => this.linkClicked()} text={`${this.langTasks?.label} ${this.checkingList?.length || ''}`} icon=\"chevrons-right\" text-enabled></calcite-action> */}\n                <calcite-action onClick={() => this.switchState('report-list')} icon=\"chevrons-right\" text-enabled>\n                  <span>{this.langTasks?.label}</span>\n                  {this.checkingList?.length ? \n                  <Fragment>\n                    <div class=\"task-num\" id='task-num'>\n                      <span>{`${this.checkingList.length || ''}`}</span>\n                    </div>\n\n                    <calcite-tooltip label={this.langTasks.panelNumberTip} reference-element=\"task-num\">\n                      <span>{this.langTasks.panelNumberTip}</span>\n                    </calcite-tooltip>\n                    </Fragment>\n                    : null\n                  }\n                </calcite-action>\n\n                {/* <calcite-action onClick={() => this.linkClicked()} text={this.langTasks?.label} icon=\"chevrons-right\" text-enabled></calcite-action> */}\n              </div> \n            }\n          </div>\n            \n          { this.token ? \n            <task-list style={{display: (this.state === 'report-list') ? 'block': 'none'}} jobs={this.jobs} onGoBackClicked={() => {this.state = 'generate-report'}}></task-list> \n          : ''}\n          \n          {\n            this.error ?\n            <calcite-alert slot=\"alerts\" open onCalciteAlertClose={() => {this.error = null;}} label={this.error.html} icon kind={this.error.alertType || 'danger'} placement=\"top\" scale=\"s\">\n              {/* <div slot=\"title\">{this.error.html}</div> */}\n              <div class=\"error-message\" slot=\"message\">\n                {this.error.html}\n                {this.error.detail ?\n                  <p innerHTML={this.error.detail}>\n                  </p>\n                  : null\n                }\n                </div>\n              {/* <calcite-link slot=\"link\">Link</calcite-link> */}\n            </calcite-alert>\n            : null\n          }\n          {this.state === 'login' && !PropsService.token ? \n          <calcite-modal aria-labelledby=\"modal-title\" id=\"login-modal\" outside-close-disabled=\"true\" scale=\"s\" width-scale=\"s\" close-button-disabled=\"true\" open=\"true\">\n            <div slot=\"header\" id=\"modal-title\">\n            {this.langCommon?.signIn}\n            </div>\n            <div slot=\"content\">\n              <calcite-label style={{height: '100px'}}>\n                <p>{this.langCommon?.signInMsg}</p>\n                <calcite-button id=\"reportLoginBtn\" kind=\"brand\" onClick={() => this.startLogin()}>\n                  {this.langCommon?.signIn}\n                </calcite-button>\n              </calcite-label>\n            </div>\n          </calcite-modal>\n          : ''}\n        </calcite-panel>\n      <slot></slot>\n      </Host>\n    );\n  }\n\n}\n"]}